<!DOCTYPE html>
<html lang="bg">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ImotIQ ‚Äî –¶–µ–Ω–æ–≤–∏ –¢—Ä–µ–Ω–¥</title>
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=DM+Sans:wght@300;400;500&family=DM+Mono:wght@400;500&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.min.js"></script>
<style>
  :root {
    --gold:#C9A84C; --gold-light:#E8C97A; --gold-dim:rgba(201,168,76,0.12);
    --dark:#0A0A0F; --dark-2:#111118; --dark-3:#1A1A24;
    --cream:#F5F0E8; --cream-dim:#D4CCB8;
    --green:#2ECC8A; --green-dim:rgba(46,204,138,0.12);
    --red:#E84C4C; --red-dim:rgba(232,76,76,0.12);
    --blue:#4C7AC9; --blue-dim:rgba(76,122,201,0.12);
    --purple:#9B59B6; --purple-dim:rgba(155,89,182,0.12);
    --sidebar:260px;
  }
  *{margin:0;padding:0;box-sizing:border-box;}
  body{background:var(--dark);color:var(--cream);font-family:'DM Sans',sans-serif;display:flex;min-height:100vh;cursor:auto;}
  .cursor{width:10px;height:10px;background:var(--gold);border-radius:50%;position:fixed;pointer-events:none;z-index:9999;transition:transform 0.15s;mix-blend-mode:difference;}
  .cursor-ring{width:32px;height:32px;border:1px solid rgba(201,168,76,0.5);border-radius:50%;position:fixed;pointer-events:none;z-index:9998;transition:all 0.08s;}

  /* SIDEBAR */
  .sidebar{width:var(--sidebar);min-height:100vh;background:var(--dark-2);border-right:1px solid rgba(255,255,255,0.05);display:flex;flex-direction:column;position:fixed;top:0;left:0;bottom:0;z-index:50;}
  .sidebar-logo{padding:28px 24px 24px;border-bottom:1px solid rgba(255,255,255,0.05);font-family:'Syne',sans-serif;font-weight:800;font-size:1.4rem;}
  .sidebar-logo span{color:var(--gold);}
  .sidebar-section{padding:20px 16px 8px;font-size:0.62rem;text-transform:uppercase;letter-spacing:0.14em;color:rgba(212,204,184,0.3);}
  .nav-item{display:flex;align-items:center;gap:12px;padding:10px 16px;margin:2px 8px;border-radius:8px;cursor:auto;transition:all 0.2s;color:var(--cream-dim);font-size:0.88rem;text-decoration:none;position:relative;}
  .nav-item:hover{background:rgba(255,255,255,0.04);color:var(--cream);}
  .nav-item.active{background:var(--gold-dim);color:var(--gold);}
  .nav-item.active::before{content:'';position:absolute;left:-8px;top:50%;transform:translateY(-50%);width:3px;height:60%;background:var(--gold);border-radius:0 3px 3px 0;}
  .nav-icon{width:18px;font-size:1rem;text-align:center;}
  .nav-badge{margin-left:auto;background:var(--gold);color:var(--dark);font-size:0.6rem;font-weight:700;padding:2px 7px;border-radius:100px;font-family:'Syne',sans-serif;}
  .sidebar-bottom{margin-top:auto;padding:16px;border-top:1px solid rgba(255,255,255,0.05);}
  .plan-widget{background:var(--gold-dim);border:1px solid rgba(201,168,76,0.2);border-radius:10px;padding:14px;margin-bottom:12px;}
  .plan-name{font-family:'Syne',sans-serif;font-weight:700;font-size:0.75rem;color:var(--gold);margin-bottom:4px;}
  .plan-usage{font-size:0.72rem;color:var(--cream-dim);margin-bottom:8px;}
  .usage-bar{height:3px;background:rgba(255,255,255,0.08);border-radius:3px;overflow:hidden;}
  .usage-fill{height:100%;background:var(--gold);border-radius:3px;}
  .upgrade-btn{display:block;text-align:center;padding:8px;background:var(--gold);color:var(--dark);border-radius:6px;font-family:'Syne',sans-serif;font-weight:700;font-size:0.72rem;text-decoration:none;margin-top:10px;cursor:auto;transition:background 0.2s;}
  .upgrade-btn:hover{background:var(--gold-light);}
  .user-row{display:flex;align-items:center;gap:10px;}
  .avatar{width:34px;height:34px;background:linear-gradient(135deg,var(--gold),#8B6A1F);border-radius:50%;display:flex;align-items:center;justify-content:center;font-family:'Syne',sans-serif;font-weight:700;font-size:0.8rem;color:var(--dark);flex-shrink:0;}
  .user-name{font-size:0.82rem;font-weight:500;}
  .user-plan{font-size:0.7rem;color:var(--cream-dim);}
  .logout-btn{margin-left:auto;background:none;border:none;color:rgba(212,204,184,0.3);cursor:auto;font-size:0.8rem;transition:color 0.2s;}
  .logout-btn:hover{color:var(--red);}

  /* MAIN */
  .main{margin-left:var(--sidebar);flex:1;display:flex;flex-direction:column;}
  .topbar{padding:20px 36px;border-bottom:1px solid rgba(255,255,255,0.05);display:flex;align-items:center;justify-content:space-between;background:var(--dark);position:sticky;top:0;z-index:40;}
  .page-title{font-family:'Syne',sans-serif;font-weight:700;font-size:1.1rem;}
  .notif-btn{width:36px;height:36px;background:var(--dark-3);border:1px solid rgba(255,255,255,0.06);border-radius:8px;display:flex;align-items:center;justify-content:center;cursor:auto;font-size:1rem;position:relative;}
  .notif-dot{position:absolute;top:6px;right:6px;width:7px;height:7px;background:var(--gold);border-radius:50%;border:1.5px solid var(--dark);}
  .content{padding:32px 36px;flex:1;}

  /* HERO STATS */
  .hero-stats{display:grid;grid-template-columns:repeat(4,1fr);gap:12px;margin-bottom:24px;}
  .hero-stat{background:var(--dark-3);border:1px solid rgba(255,255,255,0.05);border-radius:12px;padding:20px;position:relative;overflow:hidden;transition:border-color 0.2s;}
  .hero-stat:hover{border-color:rgba(201,168,76,0.2);}
  .hero-stat::after{content:'';position:absolute;bottom:0;left:0;right:0;height:2px;background:var(--hcolor,var(--gold));opacity:0.4;}
  .hs-label{font-size:0.65rem;text-transform:uppercase;letter-spacing:0.1em;color:rgba(212,204,184,0.4);margin-bottom:8px;}
  .hs-val{font-family:'Syne',sans-serif;font-weight:800;font-size:1.7rem;line-height:1;}
  .hs-sub{font-size:0.73rem;color:var(--cream-dim);margin-top:4px;}
  .hs-trend{display:inline-flex;align-items:center;gap:4px;font-size:0.72rem;margin-top:8px;padding:3px 8px;border-radius:100px;}
  .hs-trend.up{background:var(--green-dim);color:var(--green);}
  .hs-trend.down{background:var(--red-dim);color:var(--red);}

  /* MAIN CHART CARD */
  .chart-card{background:var(--dark-3);border:1px solid rgba(255,255,255,0.06);border-radius:16px;padding:28px;margin-bottom:20px;position:relative;overflow:hidden;}
  .chart-card::before{content:'';position:absolute;top:0;left:0;right:0;height:2px;background:linear-gradient(90deg,var(--gold),transparent);}
  .chart-header{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:24px;gap:16px;flex-wrap:wrap;}
  .chart-title{font-family:'Syne',sans-serif;font-weight:700;font-size:1rem;margin-bottom:4px;}
  .chart-sub{font-size:0.75rem;color:var(--cream-dim);}

  /* PERIOD TABS */
  .period-tabs{display:flex;gap:4px;background:rgba(255,255,255,0.04);border-radius:8px;padding:4px;}
  .ptab{padding:6px 14px;border-radius:5px;border:none;background:none;color:var(--cream-dim);font-size:0.78rem;cursor:auto;transition:all 0.2s;font-family:'DM Sans',sans-serif;}
  .ptab.active{background:var(--gold-dim);color:var(--gold);border:1px solid rgba(201,168,76,0.25);}
  .ptab:hover:not(.active){color:var(--cream);}

  /* TYPE TOGGLE */
  .type-toggle{display:flex;gap:6px;}
  .type-btn{padding:6px 14px;border:1px solid rgba(255,255,255,0.08);border-radius:6px;background:none;color:var(--cream-dim);font-size:0.76rem;cursor:auto;transition:all 0.2s;font-family:'DM Sans',sans-serif;}
  .type-btn.active{background:var(--blue-dim);border-color:rgba(76,122,201,0.3);color:var(--blue);}
  .type-btn:hover:not(.active){border-color:rgba(255,255,255,0.15);color:var(--cream);}

  /* ANNOTATION */
  .chart-annotation{position:absolute;top:88px;right:28px;background:rgba(201,168,76,0.12);border:1px solid rgba(201,168,76,0.25);border-radius:8px;padding:8px 12px;font-size:0.72rem;color:var(--gold);}

  /* BOTTOM GRID */
  .bottom-grid{display:grid;grid-template-columns:1fr 1fr;gap:16px;margin-bottom:20px;}
  .panel{background:var(--dark-3);border:1px solid rgba(255,255,255,0.06);border-radius:16px;overflow:hidden;}
  .panel-head{padding:18px 22px;border-bottom:1px solid rgba(255,255,255,0.05);display:flex;justify-content:space-between;align-items:center;}
  .panel-title{font-family:'Syne',sans-serif;font-weight:700;font-size:0.9rem;}

  /* YOY TABLE */
  .yoy-row{display:grid;grid-template-columns:1fr auto auto;gap:12px;align-items:center;padding:12px 22px;border-bottom:1px solid rgba(255,255,255,0.03);}
  .yoy-row:last-child{border-bottom:none;}
  .yoy-row:hover{background:rgba(255,255,255,0.02);}
  .yoy-name{font-size:0.84rem;font-weight:500;}
  .yoy-price{font-family:'DM Mono',monospace;font-size:0.8rem;color:var(--cream-dim);}
  .yoy-change{font-family:'Syne',sans-serif;font-weight:700;font-size:0.82rem;text-align:right;min-width:60px;}
  .yoy-bar-wrap{grid-column:1/-1;height:3px;background:rgba(255,255,255,0.05);border-radius:3px;overflow:hidden;margin-top:-8px;}
  .yoy-bar{height:100%;border-radius:3px;}

  /* FORECAST PANEL */
  .forecast-panel{background:linear-gradient(135deg,rgba(201,168,76,0.07),rgba(201,168,76,0.02));border:1px solid rgba(201,168,76,0.18);border-radius:16px;padding:0;overflow:hidden;margin-bottom:20px;}
  .forecast-panel::before{content:'';display:block;height:2px;background:linear-gradient(90deg,var(--gold),transparent);}
  .fp-head{padding:20px 24px;border-bottom:1px solid rgba(201,168,76,0.1);}
  .fp-title{font-family:'Syne',sans-serif;font-weight:700;font-size:0.9rem;}
  .fp-sub{font-size:0.74rem;color:var(--cream-dim);margin-top:3px;}
  .forecast-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:1px;background:rgba(201,168,76,0.08);}
  .fc-item{background:var(--dark-3);padding:22px;text-align:center;}
  .fc-period{font-size:0.65rem;text-transform:uppercase;letter-spacing:0.1em;color:var(--cream-dim);margin-bottom:8px;}
  .fc-val{font-family:'Syne',sans-serif;font-weight:800;font-size:1.6rem;line-height:1;}
  .fc-val.up{color:var(--green);}
  .fc-val.down{color:var(--red);}
  .fc-price{font-size:0.76rem;color:var(--cream-dim);margin-top:4px;font-family:'DM Mono',monospace;}
  .fc-conf{display:inline-flex;align-items:center;gap:4px;margin-top:8px;font-size:0.65rem;padding:2px 8px;border-radius:100px;background:rgba(255,255,255,0.05);color:var(--cream-dim);}

  /* EVENTS */
  .event-row{display:flex;gap:16px;padding:14px 22px;border-bottom:1px solid rgba(255,255,255,0.03);align-items:flex-start;}
  .event-row:last-child{border-bottom:none;}
  .event-year{font-family:'Syne',sans-serif;font-weight:800;font-size:0.78rem;color:var(--gold);min-width:36px;margin-top:2px;}
  .event-line{width:1px;background:rgba(201,168,76,0.2);align-self:stretch;margin:0 4px;flex-shrink:0;}
  .event-info{}
  .event-title{font-size:0.84rem;font-weight:500;margin-bottom:3px;}
  .event-desc{font-size:0.74rem;color:var(--cream-dim);line-height:1.5;}
  .event-impact{display:inline-flex;align-items:center;gap:4px;font-size:0.65rem;padding:2px 7px;border-radius:4px;font-family:'Syne',sans-serif;font-weight:600;margin-top:5px;}

  @keyframes fadeUp{from{opacity:0;transform:translateY(16px)}to{opacity:1;transform:translateY(0)}}
  .fade-in{animation:fadeUp 0.5s ease both;}
  .fade-in:nth-child(2){animation-delay:0.06s;}
  .fade-in:nth-child(3){animation-delay:0.12s;}
  .fade-in:nth-child(4){animation-delay:0.18s;}

  /* ‚îÄ‚îÄ MOBILE RESPONSIVE ‚îÄ‚îÄ */
  .mobile-overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.7);z-index:49;backdrop-filter:blur(4px);}
  .burger{display:none;flex-direction:column;gap:5px;cursor:auto;padding:8px;background:var(--dark-3);border:1px solid rgba(255,255,255,0.08);border-radius:8px;}
  .burger span{display:block;width:20px;height:2px;background:var(--cream);border-radius:2px;transition:all 0.3s;}
  .burger.open span:nth-child(1){transform:translateY(7px) rotate(45deg);}
  .burger.open span:nth-child(2){opacity:0;}
  .burger.open span:nth-child(3){transform:translateY(-7px) rotate(-45deg);}

  @media(max-width:900px){
    .sidebar{transform:translateX(-100%);transition:transform 0.3s ease;box-shadow:none;}
    .sidebar.open{transform:translateX(0);box-shadow:8px 0 40px rgba(0,0,0,0.5);}
    .mobile-overlay.show{display:block;}
    .main{margin-left:0 !important;}
    .burger{display:flex;}
    .content{padding:20px 16px !important;}
    .topbar{padding:14px 16px !important;}
    /* Stack grids on mobile */
    .stats-grid,.summary-grid,.hero-stats{grid-template-columns:1fr 1fr !important;}
    .bottom-grid,.main-grid,.comparison,.bottom-row{grid-template-columns:1fr !important;}
    .calc-layout,.settings-layout{grid-template-columns:1fr !important;}
    .district-grid{grid-template-columns:1fr 1fr !important;}
    .forecast-grid{grid-template-columns:1fr 1fr !important;}
    .alert-form{grid-template-columns:1fr 1fr !important;}
    .alert-main{grid-template-columns:auto 1fr !important;}
    .alert-stats,.alert-actions{display:none !important;}
    .plans-grid{grid-template-columns:1fr !important;}
    .chart-header{flex-direction:column !important;gap:12px !important;}
    .url-row,.url-input-wrap{flex-wrap:wrap !important;}
    .url-inp,.url-input{border-right:1px solid rgba(201,168,76,0.15) !important;border-radius:8px !important;margin-bottom:8px !important;width:100% !important;}
    .scan-btn,.analyze-btn{border-radius:8px !important;width:100% !important;justify-content:center !important;}
    .infra-grid{grid-template-columns:repeat(3,1fr) !important;}
    .chips-wrap{padding-bottom:8px !important;}
  }
  @media(max-width:500px){
    .stats-grid,.summary-grid,.hero-stats{grid-template-columns:1fr !important;}
    .district-grid,.forecast-grid{grid-template-columns:1fr !important;}
    .score-overview{grid-template-columns:1fr !important;}
    .score-main{border-right:none !important;border-bottom:1px solid rgba(255,255,255,0.05) !important;}
    .checks-grid{grid-template-columns:1fr !important;}
  }

  /* ‚îÄ‚îÄ PAGE TRANSITIONS ‚îÄ‚îÄ */
  body{opacity:0;animation:pageIn 0.35s ease forwards;}
  @keyframes pageIn{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}
  .page-exit{animation:pageOut 0.25s ease forwards !important;}
  @keyframes pageOut{to{opacity:0;transform:translateY(-8px)}}

  /* ‚îÄ‚îÄ CURSOR FIX ‚îÄ‚îÄ */
  *, *::before, *::after { cursor: auto !important; }
  .cursor { cursor: auto !important; }
  @media (max-width: 900px) {
    *, *::before, *::after { cursor: auto !important; }
    .cursor, .cursor-ring { display: none !important; }
  }


  /* ‚îÄ‚îÄ SIDEBAR SCROLL FIX ‚îÄ‚îÄ */
  .sidebar {
    overflow-y: auto !important;
    overflow-x: hidden !important;
  }
  .sidebar::-webkit-scrollbar { width: 3px; }
  .sidebar::-webkit-scrollbar-track { background: transparent; }
  .sidebar::-webkit-scrollbar-thumb { background: rgba(201,168,76,0.2); border-radius: 3px; }
  .sidebar-bottom {
    position: sticky !important;
    bottom: 0 !important;
    background: var(--dark-2) !important;
    z-index: 2 !important;
    border-top: 1px solid rgba(255,255,255,0.05) !important;
  }


  /* ‚îÄ‚îÄ CURSOR OVERRIDE ‚îÄ‚îÄ */
  *, *::before, *::after { cursor: auto !important; }
  .cursor, .cursor-ring { display: none !important; }
  a, button, [onclick], select, input, label { cursor: pointer !important; }
</style>

  <!-- ImotIQ Config -->
  <script>
    const IMOTIQ_CONFIG = {
      BACKEND_URL: 'https://script.google.com/macros/s/AKfycbwoeXmjOnfCxZIQBGvb3OqEBAAC2bpkG9INcDlyTX8n0_KlLDqjvr0t2o2IrdlkUh1WSA/exec',
      VERSION: '1.0',
    };

    // ‚îÄ‚îÄ API HELPER ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    async function apiCall(action, data = {}) {
      try {
        const res = await fetch(IMOTIQ_CONFIG.BACKEND_URL, {
          method: 'POST',
          body: JSON.stringify({ action, ...data }),
        });
        return await res.json();
      } catch(e) {
        console.error('API error:', e);
        return { success: false, error: e.message };
      }
    }

    // ‚îÄ‚îÄ SESSION ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    function getSession() { return localStorage.getItem('imotiq_session'); }
    function getUser()    { return JSON.parse(localStorage.getItem('imotiq_user') || 'null'); }

    function checkSession() {
      if(!getSession() && !window.location.href.includes('landing')) {
        window.location.href = 'imotiq-landing.html';
      }
    }

    // ‚îÄ‚îÄ LOGOUT ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    async function logout() {
      await apiCall('logout', { sessionId: getSession() });
      localStorage.clear();
      window.location.href = 'imotiq-landing.html';
    }
  </script>

</head>
<body>
<script>
    // ‚îÄ‚îÄ –ü–†–û–í–ï–†–ö–ê –ù–ê –°–ï–°–ò–Ø ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    (function() {
      var sess = localStorage.getItem('imotiq_session');
      var user = JSON.parse(localStorage.getItem('imotiq_user') || 'null');
      // –ê–∫–æ –Ω—è–º–∞ —Å–µ—Å–∏—è –∏–ª–∏ –µ —Ñ–∞–ª—à–∏–≤–∞—Ç–∞ —Ç–µ—Å—Ç–æ–≤–∞ ‚Äî –≤—ä—Ä–Ω–∏ –∫—ä–º landing
      if (!sess || !user || user.email === 'test@example.bg' || user.id === 'user_001') {
        localStorage.clear();
        window.location.replace('imotiq-landing.html');
      }
    })();
</script>
<div class="cursor" id="cursor"></div>
<div class="cursor-ring" id="cursorRing"></div>

<!-- SIDEBAR -->
<aside class="sidebar">
  <div class="sidebar-logo">Imot<span>IQ</span></div>
  <div style="padding:12px 8px 0;">
    <div class="sidebar-section">–ì–ª–∞–≤–Ω–æ</div>
    <a class="nav-item" href="imotiq-dashboard.html"><span class="nav-icon">‚ö°</span> Dashboard</a>
    <a class="nav-item" href="imotiq-dashboard.html"><span class="nav-icon">üß†</span> AI –ê–Ω–∞–ª–∏–∑</a>
    <a class="nav-item" href="imotiq-alerts.html"><span class="nav-icon">üîî</span> –ú–æ–∏—Ç–µ Alerts<span class="nav-badge">3</span></a>
    <div class="sidebar-section">–ü–∞–∑–∞—Ä</div>
    <a class="nav-item" href="imotiq-tracker.html"><span class="nav-icon">üìä</span> –ö–≤–∞—Ä—Ç–∞–ª–µ–Ω –¢—Ä–µ–∫–µ—Ä</a>
    <a class="nav-item active" href="#"><span class="nav-icon">üìà</span> –¶–µ–Ω–æ–≤–∏ –¢—Ä–µ–Ω–¥</a>
    <a class="nav-item" href="imotiq-report.html"><span class="nav-icon">üèòÔ∏è</span> –ö–≤–∞—Ä—Ç–∞–ª–µ–Ω –î–æ–∫–ª–∞–¥</a>
    <div class="sidebar-section">–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏</div>
    <a class="nav-item" href="imotiq-calculator.html"><span class="nav-icon">‚öñÔ∏è</span> –ù–∞–µ–º vs –ö—É–ø—É–≤–∞–Ω–µ</a>
    <a class="nav-item" href="imotiq-detector.html"><span class="nav-icon">üîç</span> –§–∞–ª—à–∏–≤–∏ –û–±—è–≤–∏</a>
    <a class="nav-item" href="imotiq-history.html"><span class="nav-icon">üìã</span> –ò—Å—Ç–æ—Ä–∏—è</a>
    <div class="sidebar-section">–ê–∫–∞—É–Ω—Ç</div>
    <a class="nav-item" href="imotiq-settings.html"><span class="nav-icon">‚öôÔ∏è</span> –ù–∞—Å—Ç—Ä–æ–π–∫–∏</a>
  </div>
  <div class="sidebar-bottom">
    <div class="plan-widget">
      <div class="plan-name">üÜì –ë–µ–∑–ø–ª–∞—Ç–µ–Ω –ø–ª–∞–Ω</div>
      <div class="plan-usage">1 –æ—Ç 1 –∞–Ω–∞–ª–∏–∑–∞ –∏–∑–ø–æ–ª–∑–≤–∞–Ω</div>
      <div class="usage-bar"><div class="usage-fill" style="width:100%"></div></div>
      <a href="#" class="upgrade-btn">–ù–∞–¥–≥—Ä–∞–¥–∏ –∫—ä–º –°—Ç–∞–Ω–¥–∞—Ä—Ç ‚Üí</a>
    </div>
    <div class="user-row">
      <div class="avatar">–ò–ò</div>
      <div><div class="user-name">–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤</div><div class="user-plan">–ë–µ–∑–ø–ª–∞—Ç–µ–Ω –ø–ª–∞–Ω</div></div>
      <button class="logout-btn" onclick="logout()">‚èª</button>
    </div>
  </div>
</aside>

<!-- MAIN -->
<main class="main">
  <div class="topbar">
    <div class="page-title">üìà –¶–µ–Ω–æ–≤–∏ –¢—Ä–µ–Ω–¥</div>
    <div style="display:flex;align-items:center;gap:12px;">
      <div style="font-size:0.78rem;color:var(--cream-dim)" id="currentDate"></div>
      <div class="notif-btn">üîî<div class="notif-dot"></div></div>
    </div>
  </div>

  <div class="content">

    <!-- HERO STATS -->
    <div class="hero-stats">
      <div class="hero-stat fade-in" style="--hcolor:#C9A84C">
        <div class="hs-label">–°—Ä–µ–¥–Ω–∞ —Ü–µ–Ω–∞ –°–æ—Ñ–∏—è</div>
        <div class="hs-val">2,180</div>
        <div class="hs-sub">–ª–≤ / –º¬≤ ‚Äî –§–µ–≤—Ä—É–∞—Ä–∏ 2025</div>
        <div class="hs-trend up">‚Üë +18.4% –∑–∞ –≥–æ–¥–∏–Ω–∞</div>
      </div>
      <div class="hero-stat fade-in" style="--hcolor:#2ECC8A">
        <div class="hs-label">–†—ä—Å—Ç –ø–æ—Å–ª–µ–¥–µ–Ω –º–µ—Å–µ—Ü</div>
        <div class="hs-val">+2.1%</div>
        <div class="hs-sub">—Å–ø—Ä—è–º–æ –Ø–Ω—É–∞—Ä–∏ 2025</div>
        <div class="hs-trend up">‚Üë –ù–∞–π-–±—ä—Ä–∑–æ –æ—Ç 2022–≥</div>
      </div>
      <div class="hero-stat fade-in" style="--hcolor:#4C7AC9">
        <div class="hs-label">–û–±–µ–º —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏</div>
        <div class="hs-val">1,847</div>
        <div class="hs-sub">—Å–¥–µ–ª–∫–∏ –ø—Ä–µ–∑ –Ø–Ω—É–∞—Ä–∏</div>
        <div class="hs-trend up">‚Üë +12% YoY</div>
      </div>
      <div class="hero-stat fade-in" style="--hcolor:#9B59B6">
        <div class="hs-label">–ü—Ä–æ–≥–Ω–æ–∑–∞ 12 –º–µ—Å–µ—Ü–∞</div>
        <div class="hs-val">+11%</div>
        <div class="hs-sub">–æ—á–∞–∫–≤–∞–Ω —Ä—ä—Å—Ç –Ω–∞ —Ü–µ–Ω–∏—Ç–µ</div>
        <div class="hs-trend up">‚Üë –£–≤–µ—Ä–µ–Ω–æ—Å—Ç 64%</div>
      </div>
    </div>

    <!-- MAIN CHART -->
    <div class="chart-card fade-in">
      <div class="chart-header">
        <div>
          <div class="chart-title">–ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏ —Ü–µ–Ω–æ–≤–∏ —Ç—Ä–µ–Ω–¥ ‚Äî –°–æ—Ñ–∏—è</div>
          <div class="chart-sub" id="chartSub">–°—Ä–µ–¥–Ω–∞ —Ü–µ–Ω–∞ –ª–≤/–º¬≤ + AI –ø—Ä–æ–≥–Ω–æ–∑–∞ (–ø—É–Ω–∫—Ç–∏—Ä–∞–Ω–æ)</div>
        </div>
        <div style="display:flex;gap:12px;align-items:center;flex-wrap:wrap;">
          <div class="type-toggle">
            <button class="type-btn active" onclick="setType(this,'sqm')">–ª–≤/–º¬≤</button>
            <button class="type-btn" onclick="setType(this,'total')">–°—Ä–µ–¥–Ω–∞ —Å–¥–µ–ª–∫–∞</button>
            <button class="type-btn" onclick="setType(this,'rent')">–ù–∞–µ–º</button>
          </div>
          <div class="period-tabs">
            <button class="ptab" onclick="setPeriod(this,3)">3–≥</button>
            <button class="ptab active" onclick="setPeriod(this,5)">5–≥</button>
            <button class="ptab" onclick="setPeriod(this,10)">10–≥</button>
            <button class="ptab" onclick="setPeriod(this,0)">–í—Å–∏—á–∫–æ</button>
          </div>
        </div>
      </div>
      <canvas id="mainChart" height="80"></canvas>
    </div>

    <!-- BOTTOM GRID -->
    <div class="bottom-grid">

      <!-- YOY COMPARISON -->
      <div class="panel fade-in">
        <div class="panel-head">
          <div class="panel-title">üìä –ì–æ–¥–∏—à–µ–Ω —Ä—ä—Å—Ç –ø–æ –∫–≤–∞—Ä—Ç–∞–ª–∏</div>
          <span style="font-size:0.72rem;color:var(--cream-dim)">2024 vs 2023</span>
        </div>

        <div class="yoy-row">
          <div class="yoy-name">üå≤ –°–∏–º–µ–æ–Ω–æ–≤–æ</div>
          <div class="yoy-price">3,100 –ª–≤/–º¬≤</div>
          <div class="yoy-change" style="color:var(--green)">+22.4%</div>
          <div class="yoy-bar-wrap"><div class="yoy-bar" style="width:100%;background:var(--green)"></div></div>
        </div>
        <div class="yoy-row">
          <div class="yoy-name">üè° –ë–æ—è–Ω–∞</div>
          <div class="yoy-price">2,850 –ª–≤/–º¬≤</div>
          <div class="yoy-change" style="color:var(--green)">+19.8%</div>
          <div class="yoy-bar-wrap"><div class="yoy-bar" style="width:88%;background:var(--green)"></div></div>
        </div>
        <div class="yoy-row">
          <div class="yoy-name">üèôÔ∏è –õ–æ–∑–µ–Ω–µ—Ü</div>
          <div class="yoy-price">3,240 –ª–≤/–º¬≤</div>
          <div class="yoy-change" style="color:var(--green)">+18.7%</div>
          <div class="yoy-bar-wrap"><div class="yoy-bar" style="width:83%;background:var(--green)"></div></div>
        </div>
        <div class="yoy-row">
          <div class="yoy-name">üèóÔ∏è –õ—é–ª–∏–Ω</div>
          <div class="yoy-price">1,340 –ª–≤/–º¬≤</div>
          <div class="yoy-change" style="color:var(--green)">+15.2%</div>
          <div class="yoy-bar-wrap"><div class="yoy-bar" style="width:68%;background:var(--green)"></div></div>
        </div>
        <div class="yoy-row">
          <div class="yoy-name">üè¢ –ú–ª–∞–¥–æ—Å—Ç</div>
          <div class="yoy-price">2,180 –ª–≤/–º¬≤</div>
          <div class="yoy-change" style="color:var(--green)">+12.4%</div>
          <div class="yoy-bar-wrap"><div class="yoy-bar" style="width:55%;background:var(--green)"></div></div>
        </div>
        <div class="yoy-row">
          <div class="yoy-name">üèòÔ∏è –ù–∞–¥–µ–∂–¥–∞</div>
          <div class="yoy-price">1,560 –ª–≤/–º¬≤</div>
          <div class="yoy-change" style="color:var(--gold)">+6.8%</div>
          <div class="yoy-bar-wrap"><div class="yoy-bar" style="width:30%;background:var(--gold)"></div></div>
        </div>
        <div class="yoy-row">
          <div class="yoy-name">üéì –°—Ç—É–¥–µ–Ω—Ç—Å–∫–∏</div>
          <div class="yoy-price">1,820 –ª–≤/–º¬≤</div>
          <div class="yoy-change" style="color:var(--red)">-1.2%</div>
          <div class="yoy-bar-wrap"><div class="yoy-bar" style="width:5%;background:var(--red)"></div></div>
        </div>
      </div>

      <!-- MARKET EVENTS -->
      <div class="panel fade-in">
        <div class="panel-head">
          <div class="panel-title">üìÖ –ö–ª—é—á–æ–≤–∏ –ø–∞–∑–∞—Ä–Ω–∏ —Å—ä–±–∏—Ç–∏—è</div>
        </div>
        <div class="event-row">
          <div class="event-year">2020</div>
          <div class="event-line"></div>
          <div class="event-info">
            <div class="event-title">COVID-19 ‚Äî –í—Ä–µ–º–µ–Ω–µ–Ω —Å–ø–∞–¥</div>
            <div class="event-desc">–ü–∞–∑–∞—Ä—ä—Ç –∑–∞–º—Ä—è–≤–∞ –∑–∞ 6 –º–µ—Å–µ—Ü–∞, —Å–ª–µ–¥ –∫–æ–µ—Ç–æ —Å–µ –≤—ä–∑—Å—Ç–∞–Ω–æ–≤—è–≤–∞ —Ä—è–∑–∫–æ —Å –±—É–º –Ω–∞ —Ç—ä—Ä—Å–µ–Ω–µ—Ç–æ –∑–∞ –ø–æ-–≥–æ–ª–µ–º–∏ –∂–∏–ª–∏—â–∞.</div>
            <span class="event-impact" style="background:var(--red-dim);color:var(--red)">üìâ -8% –∑–∞ 6 –º–µ—Å–µ—Ü–∞</span>
          </div>
        </div>
        <div class="event-row">
          <div class="event-year">2021</div>
          <div class="event-line"></div>
          <div class="event-info">
            <div class="event-title">–ü–æ—Å—Ç-COVID –±—É–º</div>
            <div class="event-desc">–†–µ–∫–æ—Ä–¥–Ω–æ —Ç—ä—Ä—Å–µ–Ω–µ —Å–ª–µ–¥ –ø–∞–Ω–¥–µ–º–∏—è—Ç–∞. –ù–∏—Å–∫–∏ –ª–∏—Ö–≤–∏ –∏ –Ω–∞—Ç—Ä—É–ø–∞–Ω–æ —Ç—ä—Ä—Å–µ–Ω–µ —Ä–∞–∑–≥–∞—Ä—è—Ç –ø–∞–∑–∞—Ä–∞.</div>
            <span class="event-impact" style="background:var(--green-dim);color:var(--green)">üìà +24% –∑–∞ –≥–æ–¥–∏–Ω–∞</span>
          </div>
        </div>
        <div class="event-row">
          <div class="event-year">2022</div>
          <div class="event-line"></div>
          <div class="event-info">
            <div class="event-title">–í–æ–π–Ω–∞ –≤ –£–∫—Ä–∞–π–Ω–∞ ‚Äî –ù–µ—Å–∏–≥—É—Ä–Ω–æ—Å—Ç</div>
            <div class="event-desc">–ö—Ä–∞—Ç–∫–æ –æ—Ö–ª–∞–∂–¥–∞–Ω–µ –∑–∞—Ä–∞–¥–∏ –≥–µ–æ–ø–æ–ª–∏—Ç–∏—á–µ—Å–∫–∞ –Ω–µ—Å–∏–≥—É—Ä–Ω–æ—Å—Ç, –Ω–æ –ø–∞–∑–∞—Ä—ä—Ç —Å–µ —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä–∞ –±—ä—Ä–∑–æ.</div>
            <span class="event-impact" style="background:var(--gold-dim);color:var(--gold)">‚Üí –°—Ç–∞–±–∏–ª–µ–Ω +4%</span>
          </div>
        </div>
        <div class="event-row">
          <div class="event-year">2023</div>
          <div class="event-line"></div>
          <div class="event-info">
            <div class="event-title">–†—ä—Å—Ç –Ω–∞ –ª–∏—Ö–≤–∏—Ç–µ ‚Äî –û—Ö–ª–∞–∂–¥–∞–Ω–µ</div>
            <div class="event-desc">–ï–¶–ë –≤–¥–∏–≥–∞ –ª–∏—Ö–≤–∏, –∏–ø–æ—Ç–µ–∫–∏—Ç–µ –ø–æ—Å–∫—ä–ø–≤–∞—Ç. –ü–∞–∑–∞—Ä—ä—Ç —Å–µ –∑–∞–±–∞–≤—è, –Ω–æ –Ω–µ –ø–∞–¥–∞.</div>
            <span class="event-impact" style="background:var(--gold-dim);color:var(--gold)">‚Üí –£–º–µ—Ä–µ–Ω +7%</span>
          </div>
        </div>
        <div class="event-row">
          <div class="event-year">2024</div>
          <div class="event-line"></div>
          <div class="event-info">
            <div class="event-title">–ï–≤—Ä–æ –æ—á–∞–∫–≤–∞–Ω–µ + –Ω–æ–≤ –±—É–º</div>
            <div class="event-desc">–û—á–∞–∫–≤–∞–Ω–æ—Ç–æ –ø—Ä–∏–µ–º–∞–Ω–µ –Ω–∞ –µ–≤—Ä–æ—Ç–æ —Ä–∞–∑–≥–∞—Ä—è –∏–Ω—Ç–µ—Ä–µ—Å–∞ –Ω–∞ —á—É–∂–¥–µ—Å—Ç—Ä–∞–Ω–Ω–∏ –∏–Ω–≤–µ—Å—Ç–∏—Ç–æ—Ä–∏.</div>
            <span class="event-impact" style="background:var(--green-dim);color:var(--green)">üìà +18.4% —Ä–µ–∫–æ—Ä–¥</span>
          </div>
        </div>
      </div>
    </div>

    <!-- AI FORECAST -->
    <div class="forecast-panel fade-in">
      <div class="fp-head">
        <div class="fp-title">ü§ñ AI –¶–µ–Ω–æ–≤–∞ –ü—Ä–æ–≥–Ω–æ–∑–∞ ‚Äî –°–æ—Ñ–∏—è (—Å—Ä–µ–¥–Ω–æ)</div>
        <div class="fp-sub">–ë–∞–∑–∏—Ä–∞–Ω–∞ –Ω–∞ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏ –¥–∞–Ω–Ω–∏, –ª–∏—Ö–≤–µ–Ω–∏ —Ç—Ä–µ–Ω–¥–∏, —Å—Ç—Ä–æ–∏—Ç–µ–ª–Ω–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –∏ –º–∞–∫—Ä–æ–∏–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏</div>
      </div>
      <div class="forecast-grid">
        <div class="fc-item">
          <div class="fc-period">1 –º–µ—Å–µ—Ü</div>
          <div class="fc-val up">+1.8%</div>
          <div class="fc-price">‚âà 2,219 –ª–≤/–º¬≤</div>
          <div class="fc-conf">üéØ –£–≤–µ—Ä–µ–Ω–æ—Å—Ç 91%</div>
        </div>
        <div class="fc-item">
          <div class="fc-period">3 –º–µ—Å–µ—Ü–∞</div>
          <div class="fc-val up">+4.2%</div>
          <div class="fc-price">‚âà 2,272 –ª–≤/–º¬≤</div>
          <div class="fc-conf">üéØ –£–≤–µ—Ä–µ–Ω–æ—Å—Ç 78%</div>
        </div>
        <div class="fc-item">
          <div class="fc-period">6 –º–µ—Å–µ—Ü–∞</div>
          <div class="fc-val up">+7.1%</div>
          <div class="fc-price">‚âà 2,335 –ª–≤/–º¬≤</div>
          <div class="fc-conf">üéØ –£–≤–µ—Ä–µ–Ω–æ—Å—Ç 65%</div>
        </div>
        <div class="fc-item">
          <div class="fc-period">12 –º–µ—Å–µ—Ü–∞</div>
          <div class="fc-val up">+11.3%</div>
          <div class="fc-price">‚âà 2,427 –ª–≤/–º¬≤</div>
          <div class="fc-conf">üéØ –£–≤–µ—Ä–µ–Ω–æ—Å—Ç 51%</div>
        </div>
      </div>
    </div>

  </div>
</main>

<script>
  
  // –ü–æ–∫–∞–∂–∏ —Ä–µ–∞–ª–Ω–æ—Ç–æ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—Å–∫–æ –∏–º–µ
  (function() {
    var u = JSON.parse(localStorage.getItem('imotiq_user') || 'null');
    if (!u || !u.name) return;
    document.querySelectorAll('.user-name').forEach(function(el) { el.textContent = u.name; });
    document.querySelectorAll('.avatar').forEach(function(el) {
      if (u.avatar) {
        el.innerHTML = '<img src="' + u.avatar + '" style="width:100%;height:100%;border-radius:50%;object-fit:cover">';
      } else {
        el.textContent = u.name.charAt(0).toUpperCase();
      }
    });
    document.querySelectorAll('.user-plan').forEach(function(el) {
      var plans = {free:'–ë–µ–∑–ø–ª–∞—Ç–µ–Ω –ø–ª–∞–Ω', standard:'–°—Ç–∞–Ω–¥–∞—Ä—Ç', pro:'–ü—Ä–æ', broker:'–ë—Ä–æ–∫–µ—Ä'};
      el.textContent = plans[u.plan] || '–ë–µ–∑–ø–ª–∞—Ç–µ–Ω –ø–ª–∞–Ω';
    });
  })();

  document.getElementById('currentDate').textContent = new Date().toLocaleDateString('bg-BG',{weekday:'long',day:'numeric',month:'long'});

  // DATA ‚Äî 5 year monthly (60 points) + 12 forecast (dashed)
  const allLabels5y = [
    '–§–µ–≤\'20','–ú–∞—Ä','–ê–ø—Ä','–ú–∞–π','–Æ–Ω–∏','–Æ–ª–∏','–ê–≤–≥','–°–µ–ø','–û–∫—Ç','–ù–æ–µ','–î–µ–∫','–Ø–Ω—É\'21',
    '–§–µ–≤','–ú–∞—Ä','–ê–ø—Ä','–ú–∞–π','–Æ–Ω–∏','–Æ–ª–∏','–ê–≤–≥','–°–µ–ø','–û–∫—Ç','–ù–æ–µ','–î–µ–∫','–Ø–Ω—É\'22',
    '–§–µ–≤','–ú–∞—Ä','–ê–ø—Ä','–ú–∞–π','–Æ–Ω–∏','–Æ–ª–∏','–ê–≤–≥','–°–µ–ø','–û–∫—Ç','–ù–æ–µ','–î–µ–∫','–Ø–Ω—É\'23',
    '–§–µ–≤','–ú–∞—Ä','–ê–ø—Ä','–ú–∞–π','–Æ–Ω–∏','–Æ–ª–∏','–ê–≤–≥','–°–µ–ø','–û–∫—Ç','–ù–æ–µ','–î–µ–∫','–Ø–Ω—É\'24',
    '–§–µ–≤','–ú–∞—Ä','–ê–ø—Ä','–ú–∞–π','–Æ–Ω–∏','–Æ–ª–∏','–ê–≤–≥','–°–µ–ø','–û–∫—Ç','–ù–æ–µ','–î–µ–∫','–Ø–Ω—É\'25','–§–µ–≤\'25'
  ];

  const historical5y = [
    1320,1280,1260,1240,1210,1190,1180,1220,1280,1340,1380,1400,
    1450,1520,1600,1680,1740,1800,1820,1840,1860,1870,1880,1890,
    1900,1920,1940,1950,1960,1960,1950,1940,1935,1930,1935,1940,
    1950,1965,1980,2000,2020,2040,2055,2070,2090,2110,2130,2145,
    2160,2175,2190,2205,2215,2220,2218,2215,2210,2195,2175,2160,2180
  ];

  const forecast12 = [null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,2180,2219,2258,2295,2330,2362,2392,2420,2445,2468,2488,2505];
  const forecastLabels = [...allLabels5y,'–ú–∞—Ä','–ê–ø—Ä','–ú–∞–π','–Æ–Ω–∏','–Æ–ª–∏','–ê–≤–≥','–°–µ–ø','–û–∫—Ç','–ù–æ–µ','–î–µ–∫','–Ø–Ω—É\'26','–§–µ–≤\'26'];

  const rentData5y = historical5y.map(v => Math.round(v * 0.006));
  const totalData5y = historical5y.map(v => Math.round(v * 78));

  let currentType = 'sqm';
  let currentPeriod = 5;
  let mainChart = null;

  function getDataset() {
    if(currentType === 'sqm') return { data: historical5y, label: '–ª–≤/–º¬≤', fore: forecast12 };
    if(currentType === 'rent') return { data: rentData5y, label: '–ª–≤/–º¬≤ –Ω–∞–µ–º', fore: rentData5y.map((_,i)=>i>60?Math.round(rentData5y[60]*1+(i-60)*0.005):null) };
    return { data: totalData5y, label: '–ª–≤ —Å—Ä–µ–¥–Ω–∞ —Å–¥–µ–ª–∫–∞', fore: totalData5y.map((_,i)=>i>60?null:null) };
  }

  function buildChart() {
    const ds = getDataset();
    const labels = currentType === 'sqm' ? forecastLabels : forecastLabels;
    const slice = currentPeriod === 0 ? 0 : currentPeriod === 10 ? 0 : currentPeriod === 5 ? 0 : 36;
    const slicedLabels = labels.slice(slice);
    const slicedHist = ds.data.slice(slice);
    const foreSlice = (currentType === 'sqm') ? forecast12.slice(slice) : Array(slicedLabels.length).fill(null);

    if(mainChart) mainChart.destroy();
    const ctx = document.getElementById('mainChart').getContext('2d');

    const gradGreen = ctx.createLinearGradient(0,0,0,300);
    gradGreen.addColorStop(0,'rgba(201,168,76,0.15)');
    gradGreen.addColorStop(1,'rgba(201,168,76,0)');

    const gradFore = ctx.createLinearGradient(0,0,0,300);
    gradFore.addColorStop(0,'rgba(76,122,201,0.1)');
    gradFore.addColorStop(1,'rgba(76,122,201,0)');

    mainChart = new Chart(ctx, {
      type: 'line',
      data: {
        labels: slicedLabels,
        datasets: [
          {
            label: '–ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∞ —Ü–µ–Ω–∞',
            data: slicedHist,
            borderColor: '#C9A84C',
            backgroundColor: gradGreen,
            tension: 0.4, borderWidth: 2.5,
            pointRadius: 0, pointHoverRadius: 6,
            fill: true
          },
          {
            label: 'AI –ü—Ä–æ–≥–Ω–æ–∑–∞',
            data: foreSlice,
            borderColor: '#4C7AC9',
            backgroundColor: gradFore,
            borderDash: [6,4],
            tension: 0.4, borderWidth: 2,
            pointRadius: 0, pointHoverRadius: 6,
            fill: true
          }
        ]
      },
      options: {
        responsive: true,
        interaction: { mode:'index', intersect:false },
        plugins: {
          legend: { display:false },
          tooltip: {
            backgroundColor:'rgba(17,17,24,0.95)',
            borderColor:'rgba(201,168,76,0.2)', borderWidth:1,
            titleColor:'#F5F0E8', bodyColor:'#D4CCB8', padding:12,
            callbacks: {
              label: c => c.raw !== null ? ` ${c.dataset.label}: ${c.parsed.y.toLocaleString()} ${currentType==='sqm'?'–ª–≤/–º¬≤':currentType==='rent'?'–ª–≤/–º¬≤':'–ª–≤'}` : ''
            }
          }
        },
        scales: {
          x: { grid:{color:'rgba(255,255,255,0.04)'}, ticks:{color:'rgba(212,204,184,0.4)',font:{size:10},maxTicksLimit:12} },
          y: { grid:{color:'rgba(255,255,255,0.04)'}, ticks:{color:'rgba(212,204,184,0.4)',font:{size:10}, callback: v => currentType==='total' ? (v/1000).toFixed(0)+'K –ª–≤' : v.toLocaleString()+' –ª–≤'} }
        },
        animation: { duration: 500 }
      }
    });
  }

  function setPeriod(btn, p) {
    document.querySelectorAll('.ptab').forEach(b=>b.classList.remove('active'));
    btn.classList.add('active');
    currentPeriod = p;
    buildChart();
  }

  function setType(btn, t) {
    document.querySelectorAll('.type-btn').forEach(b=>b.classList.remove('active'));
    btn.classList.add('active');
    currentType = t;
    buildChart();
  }

  buildChart();

  // CURSOR
  const cursor=document.getElementById('cursor'), ring=document.getElementById('cursorRing');
  let mx=0,my=0,rx=0,ry=0;
  document.addEventListener('mousemove',e=>{ mx=e.clientX; my=e.clientY; cursor.style.left=mx-5+'px'; cursor.style.top=my-5+'px'; });
  function animRing(){ rx+=(mx-rx-16)*0.12; ry+=(my-ry-16)*0.12; ring.style.left=rx+'px'; ring.style.top=ry+'px'; requestAnimationFrame(animRing); }
  animRing();
  document.querySelectorAll('a,button,input,select').forEach(el=>{ el.addEventListener('mouseenter',()=>cursor.style.transform='scale(2.5)'); el.addEventListener('mouseleave',()=>cursor.style.transform='scale(1)'); });

  // MOBILE SIDEBAR
  function toggleSidebar(){
    document.querySelector('.sidebar').classList.toggle('open');
    document.getElementById('burgerBtn').classList.toggle('open');
    document.getElementById('mobileOverlay').classList.toggle('show');
  }
  function closeSidebar(){
    document.querySelector('.sidebar').classList.remove('open');
    document.getElementById('burgerBtn').classList.remove('open');
    document.getElementById('mobileOverlay').classList.remove('show');
  }
  // Close sidebar on nav click (mobile)
  document.querySelectorAll('.nav-item').forEach(a => a.addEventListener('click', closeSidebar));

</script>
</body>
</html>
